<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
    />
    <link rel="stylesheet" href="css/bootstrap.min.css.map" />
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/flat.css" />
    <link rel="stylesheet" href="css/style.css" />

    <title>add invoice</title>
  </head>
  <body>
    <div class="nav-layer"></div>
    <!--start loader-->
    <div class="loader">
      <img src="imgs/اوامر ابيض 1.png" class="loader-img" alt="" />
      <div class="waveform">
        <div class="wave-bar"></div>
        <div class="wave-bar"></div>
        <div class="wave-bar"></div>
        <div class="wave-bar"></div>
        <div class="wave-bar"></div>
        <div class="wave-bar"></div>
        <div class="wave-bar"></div>
      </div>
    </div>
    <div class="sidebar" id="sidebar">
      <div class="close" id="closeSidebar">
        <i class="fa-solid fa-xmark"></i>
      </div>
      <div class="content">
        <div class="flex-group-me mb-4">
          <div class="logo">
            <img src="imgs/Group 1.png" alt="" />
          </div>
        </div>
        <div class="flex-info-visitor">
          <img
            src="imgs/185644495_1667380803456791_1968050560740665054_n.jpg"
            class="visitor-img"
            alt=""
          />
          <div>
            <h6 class="mb-2 dark-title">شركة اوامر الشبكة</h6>
            <div class="font14 gray-col">مدير النظام</div>
          </div>
        </div>
        <ul class="links">
          <li>
            <a href="home.html">
              <span class="icon-co">
                <img src="imgs/Group (1).png" alt="" />
              </span>
              لوحة التحكم
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
          <h6 class="mb-4 mt-4 dark-title px-3">الادارة</h6>
          <li>
            <a href="Invoices.html" class="coll-open">
              <span class="icon-co">
                <img src="imgs/Group (2).png" alt="" />
              </span>
              الفواتير
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
          <li>
            <a href="home.html">
              <span class="icon-co">
                <img src="imgs/Group (3).png" alt="" />
              </span>
              المعاملات
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
          <li>
            <a href="payment-Pages.html">
              <span class="icon-co">
                <img src="imgs/Group 178445.png" alt="" />
              </span>
              صفحات الدفع
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
          <h6 class="mb-4 mt-4 dark-title px-3">الاعدادات</h6>
          <li>
            <a href="products.html">
              <span class="icon-co">
                <img src="imgs/Group 178446.png" alt="" />
              </span>
              المنتجات
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
          <li>
            <a href="manage-account.html">
              <span class="icon-co">
                <img src="imgs/Group (4).png" alt="" />
              </span>
              ادارة الحساب التجاري
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
          <li>
            <a href="manageTeam.html">
              <span class="icon-co">
                <img src="imgs/Group (5).png" alt="" />
              </span>
              ادارة فريق العمل
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
          <li>
            <a href="profile.html">
              <span class="icon-co">
                <img src="imgs/Group (6).png" alt="" />
              </span>
              الملف الشخصي
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
          <li>
            <a href="login.html" class="log-out-red">
              <span class="icon-co">
                <img src="imgs/Group (7).png" alt="" />
              </span>
              تسجيل الخروج
              <i class="fa-solid fa-angle-left icon-right"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>

    <nav class="navbar-me" id="navbar">
      <div class="container">
        <div class="content">
          <div class="menu visible-mobile" id="menu">
            <img src="imgs/noun_List_2946302.png" alt="" />
          </div>
          <div class="flex-sm-gap px-3">
            <img src="imgs/Group.png" class="disable-mobile" alt="" />
            <div>لوحة التحكم</div>
          </div>

          <div class="left px-3">
            <button class="trans-button">
              <img src="imgs/Group 97708.png" class="lang-img" alt="" />
            </button>
            <div class="not show-noti pointer-click relative-parent">
              <i class="fa-regular fa-bell"></i>
              <span class="number">3</span>
              <ul class="my-drop-now2">
                <li>
                  <a
                    href="edit-invoice.html"
                    class="flex-in-drop no-align pointer-none default-cur"
                  >
                    <div class="noti-i-cont">
                      <i class="fa-regular fa-bell"></i>
                    </div>
                    <div>
                      <div class="in-f-text mb-2 color-black">
                        تم دفع الفاتورة رقم 221
                      </div>
                      <div class="gray-col clamp2">
                        تم دفع الفاتورة رقم 221 تم دفع الفاتورة رقم 221 تم دفع
                        الفاتورة رقم 221 تم دفع الفاتورةتم دفع الفاتورةتم دفع
                        الفاتورة رقم 221
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                  <a
                    href="edit-invoice.html"
                    class="flex-in-drop no-align pointer-none default-cur"
                  >
                    <div class="noti-i-cont">
                      <i class="fa-regular fa-bell"></i>
                    </div>
                    <div>
                      <div class="in-f-text mb-2 color-black">
                        تم دفع الفاتورة رقم 221
                      </div>
                      <div class="gray-col clamp2">
                        تم دفع الفاتورة رقم 221 تم دفع الفاتورة رقم 221 تم دفع
                        الفاتورة رقم 221 تم دفع الفاتورةتم دفع الفاتورةتم دفع
                        الفاتورة رقم 221
                      </div>
                    </div>
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <main class="main-sec" id="main">
      <div class="container">
        <div class="top-links">
          <a href="Invoices.html">الفواتير</a>
          <div class="icon-top-links">
            <i class="fa-solid fa-chevron-left"></i>
          </div>
          <div>انشاء قاتورة</div>
        </div>
        <form action="">
          <div class="main-box-dashboard mt-3 mb-4">
            <div class="main-title">انشاء فاتورة</div>

            <div class="body-main-box">
              <div class="row">
                <div class="col-lg-6 mb-3">
                  <div class="main-input-cont">
                    <div class="main-label">رقم الفاتورة</div>
                    <input
                      type="number"
                      class="main-input"
                      placeholder="الرجاء ادخال رقم الفاتورة"
                    />
                  </div>
                </div>
                <div class="col-lg-6 mb-3">
                  <div class="main-input-cont">
                    <div class="main-label">اسم العميل</div>
                    <input
                      type="text"
                      class="main-input"
                      placeholder="الرجاء ادخال اسم العميل"
                    />
                  </div>
                </div>
                <div class="col-12 mb-3">
                  <div class="danger-title">تاريخ صلاحية الفاتورة</div>
                </div>
                <div class="col-lg-6 mb-3">
                  <div class="main-input-cont">
                    <div class="main-label">تاريخ الاستحقاق</div>
                    <input
                      type="text"
                      class="main-input maindate"
                      placeholder="الرجاء تحديد تاريخ الاستحقاق"
                    />
                    <div
                      class="abs-login-left gray-col pointer-none abs-with-label"
                    >
                      <i class="fa-solid fa-calendar-days"></i>
                    </div>
                  </div>
                </div>
                <div class="col-lg-6 col-12 mb-3">
                  <div class="main-label">قبول الدفع بعد فترة الصلاحية</div>
                  <div class="checks mb-4">
                    <div class="flex-sm-gap big-gap">
                      <div class="flex-sm-gap">
                        <input
                          type="radio"
                          name="agree"
                          id="agree"
                          class="main-check"
                        />
                        <label for="agree">نعم</label>
                      </div>
                      <div class="flex-sm-gap">
                        <input
                          type="radio"
                          id="disagree"
                          class="main-check"
                          name="agree"
                        />
                        <label for="disagree">لا</label>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="all-items-main">
                  <div class="row">
                    <div class="col-lg-3 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">اسم العنصر</div>
                        <input
                          type="text"
                          class="main-input"
                          placeholder="الرجاء تحديد اسم العنصر"
                        />
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">الكمية</div>
                        <input
                          type="number"
                          class="main-input"
                          oninput="calculateQuantity(this)"
                          placeholder="الرجاء تحديد  الكمية"
                        />
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">السعر</div>
                        <input
                          type="number"
                          oninput="calculatePrice(this)"
                          class="main-input"
                          placeholder="الرجاء تحديد السعر"
                        />
                        <div class="abs-login-left abs-with-label color-main">
                          رس
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12 mb-3">
                      <div class="main-label">اجمالي السعر</div>
                      <div class="flex-sm-gap">
                        <div class="all-style w-100">
                          <div class="all-price-main"></div>
                          <div>رس</div>
                        </div>
                        <div
                          class="small-btn add-new-row up"
                          onclick="appendRowPrice(this)"
                        >
                          <i class="fa-solid fa-plus"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-12 mt-4 mb-4">
                  <div class="danger-title">ضرائب اضافية</div>
                </div>
                <div class="all-taxes-main">
                  <div class="row mb-3">
                    <div class="col-lg-4 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">اسم الضريبة</div>
                        <input
                          type="text"
                          class="main-input"
                          placeholder="الرجاء تحديد اسم الضريبة"
                        />
                      </div>
                    </div>
                    <div class="col-lg-4 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">سعر الضريبة</div>
                        <input
                          type="text"
                          oninput="calculateTax(this)"
                          class="main-input all-tax-main-input"
                          placeholder="الرجاء تحديد سعر الضريبة"
                        />
                        <div class="abs-login-left abs-with-label color-main">
                          رس
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-4 col-md-6 col-12 mb-3">
                      <div class="main-label">النسبة من الضريبة</div>
                      <div class="flex-sm-gap">
                        <div class="main-input-cont w-100">
                          <input
                            type="text"
                            class="main-input"
                            placeholder="الرجاء تحديد النسبة من الضريبة"
                          />
                          <div class="abs-login-left color-main">%</div>
                        </div>
                        <div
                          class="small-btn add-new-row up"
                          onclick="appendRowTax(this)"
                        >
                          <i class="fa-solid fa-plus"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="main-input-cont mt-5 mb-4">
                  <div class="main-label">ملاحظات</div>
                  <textarea
                    name=""
                    id=""
                    rows="6"
                    class="main-textarea"
                    placeholder="الرجاء ادخال ملاحظات"
                  ></textarea>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 mb-4">
            <div class="box-table">
              <div class="flex-bet-main mb-3">
                <div class="default-title">تفاصيل المعاملة</div>
              </div>
              <div class="shadow-table over-table print-table">
                <table class="table text-center" style="width: 100%">
                  <thead class="table-head">
                    <tr>
                      <th class="font15">اجمالي العناصر</th>
                      <th class="font15">اجمالي الضرائب</th>
                      <th class="font15">اجمالي الفاتورة</th>
                    </tr>
                  </thead>

                  <tbody data-class-name="table-body">
                    <tr>
                      <td class="font15 gray-col all-final-price">0</td>

                      <td class="font15">
                        <span class="gray-col all-tax-main">0</span>
                      </td>
                      <td class="font15">
                        <span class="gray-col finalInvoicePrice">0</span>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="flex-sm-gap">
            <button class="main-btn up" type="submit">انشاء</button>
            <button class="main-btn up bg-green" type="button">
              حفظ كمسودة
            </button>
          </div>
        </form>
      </div>
    </main>

    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/flat.js"></script>
    <script src="js/main.js"></script>
    <!--call flatpicker for due date-->
    <script>
      flatpickr(".maindate", {
        disableMobile: "true",
      });
    </script>
    <script>
      // calc all price by Quantity
      function calculateQuantity(element) {
        let allRowPrice = element
          .closest(".row")
          .querySelector(".all-price-main");
        let priceValue = element
          .closest(".col-lg-3")
          .nextElementSibling.querySelector(".main-input").value;
        if (priceValue) {
          allRowPrice.innerHTML = Number(element.value * priceValue);
          console.log(typeof allRowPrice.innerHTML);
          if (allRowPrice.innerHTML == 0) {
            allRowPrice.innerHTML = "";
          }
        }
        calcAllFinalPrice();
      }
      // calc all price by price
      function calculatePrice(element) {
        let allRowPrice = element
          .closest(".row")
          .querySelector(".all-price-main");
        let quantityValue = element
          .closest(".col-lg-3")
          .previousElementSibling.querySelector(".main-input").value;
        if (quantityValue) {
          allRowPrice.innerHTML = Number(element.value * quantityValue);
          if (allRowPrice.innerHTML == 0) {
            allRowPrice.innerHTML = "";
          }
        }
        calcAllFinalPrice();
      }
      // append price row
      function appendRowPrice(element) {
        let appendedDiv = `  <div class="row">
                    <div class="col-lg-3 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">اسم العنصر</div>
                        <input
                          type="text"
                          class="main-input"
                          placeholder="الرجاء تحديد اسم العنصر"
                        />
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">الكمية</div>
                        <input
                          type="number"
                          class="main-input"
                          oninput="calculateQuantity(this)"
                          placeholder="الرجاء تحديد  الكمية"
                        />
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">السعر</div>
                        <input
                          type="number"
                          oninput="calculatePrice(this)"
                          class="main-input"
                          placeholder="الرجاء تحديد السعر"
                        />
                        <div class="abs-login-left abs-with-label color-main">
                          رس
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-12 mb-3">
                      <div class="main-label">اجمالي السعر</div>
                      <div class="flex-sm-gap">
                        <div class="all-style w-100">
                          <div class="all-price-main"></div>
                          <div>رس</div>
                        </div>
                        <div class="small-btn add-new-row up bg-red" onclick="removeRow(this)">
                          <i class="fa-solid fa-minus"></i>
                        </div>
                      </div>
                    </div>
                  </div>`;
        element
          .closest(".all-items-main")
          .insertAdjacentHTML("beforeend", appendedDiv);
        console.log(element);
      }

      // remove row price
      function removeRow(ele) {
        ele.closest(".row").remove();
        calcAllFinalPrice();
      }
      // calc all final price
      let allFinalPrice = document.querySelector(".all-final-price");
      function calcAllFinalPrice() {
        let allprices = document.querySelectorAll(".all-price-main");
        let AllFinalPriceArray = [];
        for (let i = 0; i < allprices.length; i++) {
          AllFinalPriceArray.push(Number(allprices[i].innerHTML));
          console.log(typeof allprices[i].innerHTML);
        }
        console.log(AllFinalPriceArray);
        let result = AllFinalPriceArray.reduce((a, b) => {
          return a + b;
        });

        allFinalPrice.innerHTML = result;

        calcinvoicePrice();
      }
      // append new tax
      function appendRowTax(element) {
        let appendedDiv = ` <div class="row mb-3">
                    <div class="col-lg-4 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">اسم الضريبة</div>
                        <input
                          type="text"
                          class="main-input"
                          placeholder="الرجاء تحديد اسم الضريبة"
                        />
                      </div>
                    </div>
                    <div class="col-lg-4 col-md-6 col-12 mb-3">
                      <div class="main-input-cont">
                        <div class="main-label">سعر الضريبة</div>
                        <input
                          type="text"
                          oninput="calculateTax(this)"
                          class="main-input all-tax-main-input"
                          placeholder="الرجاء تحديد سعر الضريبة"
                        />
                        <div class="abs-login-left abs-with-label color-main">
                          رس
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-4 col-md-6 col-12 mb-3">
                      <div class="main-label">النسبة من الضريبة</div>
                      <div class="flex-sm-gap">
                        <div class="main-input-cont w-100">
                          <input
                            type="text"
                            class="main-input"
                            placeholder="الرجاء تحديد النسبة من الضريبة"
                          />
                          <div class="abs-login-left color-main">%</div>
                        </div>
                        <div
                          class="small-btn add-new-row up bg-red"
                          onclick="removeRowTax(this)"
                        >
                          <i class="fa-solid fa-minus"></i>
                        </div>
                      </div>
                    </div>
                  </div>`;
        element
          .closest(".all-taxes-main")
          .insertAdjacentHTML("beforeend", appendedDiv);
      }
      // remove row tax
      function removeRowTax(ele) {
        ele.closest(".row").remove();
        calculateTax();
      }
      // calculate Tax
      function calculateTax(element) {
        let allTaxes = document.querySelectorAll(".all-tax-main-input");
        let allTaxesArray = [];
        for (let i = 0; i < allTaxes.length; i++) {
          allTaxesArray.push(Number(allTaxes[i].value));
        }

        let result = allTaxesArray.reduce((a, b) => {
          return a + b;
        });

        console.log(allTaxesArray);

        document.querySelector(".all-tax-main").innerHTML = result;
        calcinvoicePrice();
      }
      // calc allFinal invoice price
      function calcinvoicePrice() {
        let allPricesAdded = Number(
          document.querySelector(".all-final-price").innerHTML
        );
        let allTaxesAdded = Number(
          document.querySelector(".all-tax-main").innerHTML
        );
        document.querySelector(".finalInvoicePrice").innerHTML =
          allPricesAdded + allTaxesAdded;
      }
    </script>
  </body>
</html>
